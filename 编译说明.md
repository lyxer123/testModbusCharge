# 工控测试软件编译说明

## 项目概述
这是一个基于Python tkinter的工控测试软件，包含Modbus测试和解析功能。

## 编译环境要求
- Python 3.6+
- Windows 10/11
- 必要的Python包：pyserial, pyinstaller

## 编译步骤

### 1. 安装依赖
```bash
pip install pyserial
pip install pyinstaller
```

### 2. 编译项目
```bash
pyinstaller testModbusCharge.spec
```

### 3. 运行程序
编译完成后，可执行文件位于 `dist/工控测试软件.exe`

## 文件说明

### 源代码文件
- `main.py` - 主程序文件，包含GUI界面和Modbus测试功能
- `modbus_parser.py` - Modbus解析对码功能模块
- `modbus_annotations.json` - Modbus注释数据文件

### 编译配置文件
- `testModbusCharge.spec` - PyInstaller配置文件
- `requirements.txt` - Python依赖包列表

### 生成文件
- `dist/工控测试软件.exe` - 编译后的可执行文件
- `build/` - 编译过程中的临时文件目录

## 功能特性

### 主要功能
1. **Modbus测试**
   - 串口配置（COM口、波特率、数据位、停止位、校验位）
   - 支持多种Modbus功能码（01-06, 15-16）
   - 实时数据显示（原始数据和解码数据）
   - 定时扫描功能

2. **Modbus解析对码**
   - 功能码解析
   - 数据格式转换
   - 注释管理功能
   - 数据导出功能

3. **27930测试**
   - 预留的测试功能页面

### 界面特性
- 现代化响应式设计
- 可调整窗口大小
- 多标签页界面
- 实时状态显示

## 使用说明

### 运行程序
1. 双击 `运行工控测试软件.bat` 或直接运行 `dist/工控测试软件.exe`
2. 程序启动后会显示主界面

### Modbus测试
1. 在"Modbus测试"标签页中配置串口参数
2. 选择功能码和设置寄存器参数
3. 点击"发送"按钮进行测试
4. 可以设置定时扫描间隔进行连续测试

### Modbus解析
1. 在菜单栏选择"测试" -> "modbus解析对码"
2. 选择功能码并输入十六进制数据
3. 点击"解析数据"查看解析结果
4. 可以添加和管理注释

## 注意事项

1. **串口驱动**：确保系统已安装相应的串口驱动程序
2. **权限**：某些串口操作可能需要管理员权限
3. **防火墙**：如果使用网络通信，请确保防火墙设置正确
4. **数据备份**：重要的注释数据会自动保存到 `modbus_annotations.json` 文件中

## 故障排除

### 常见问题
1. **程序无法启动**
   - 检查是否安装了所有依赖包
   - 确保Python版本兼容

2. **串口无法打开**
   - 检查串口是否被其他程序占用
   - 确认串口号是否正确
   - 检查串口驱动是否正常

3. **数据解析错误**
   - 确认数据格式是否正确
   - 检查功能码是否匹配

## 技术支持
如有问题，请检查：
1. Python环境配置
2. 依赖包安装状态
3. 系统串口驱动
4. 程序日志输出

## 版本信息
- 版本：1.0
- 编译时间：2025年
- 支持平台：Windows 10/11 